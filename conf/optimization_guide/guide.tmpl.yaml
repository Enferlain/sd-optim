# This file configures which model parameters are optimized and how.
# It works in conjunction with bounds.py to define the search space.
# For detailed explanations, see the [[Configuration]] wiki page.

components:
  # Example 1: Optimize all 'unet' parameters individually
  - name: unet
    strategy: all # Optimize every parameter for each key in this component

  # Example 2: Select specific keys (including wildcards) in 'txt1'
  # - name: txt1
  #   strategy: select
  #   keys:
  #     - "transformer.text_model.encoder.layers.10.*" # Use wildcards
  #     - "transformer.text_model.embeddings.position_embedding.weight" # Specific key

  # Example 3: Group specific keys in 'txt2' - they share the same parameter
  # - name: txt2
  #   strategy: group
  #   groups:
  #     - name: text_encoder_early_layers # Parameter name will be e.g., 'text_encoder_early_layers_alpha'
  #       keys:
  #         - "transformer.text_model.encoder.layers.0.*"
  #         - "transformer.text_model.encoder.layers.1.*"
  #     - name: text_encoder_late_layers
  #       keys:
  #         - "transformer.text_model.encoder.layers.10.*"
  #         - "transformer.text_model.encoder.layers.11.*"

  # Example 4: Treat the entire 'vae' component as a single parameter
  # - name: vae
  #   strategy: single # Parameter name will be e.g., 'vae_single_param_alpha'

  # Example 5: Do not optimize 'clip_l'
  - name: clip_l
    strategy: none

  # Example 6: Placeholder for layer adjustments (not currently optimized)
  - name: layer_adjustments
    strategy: none
    parameters: # These are NOT optimized if strategy is 'none', just kept for reference
      detail1: [-2.18, 3]
      detail2: [-2.18, 4]
      detail3: [0, 4]
      contrast: [2.18, 7.5]
      brightness: [-4, -2]
      col1: [-10, 10]
      col2: [-10, 10]
      col3: [-10, 10]

# --- Custom Bounds ---
# Optional section to override the default bounds (0.0, 1.0) for specific parameters
# generated by the strategies above.
# Parameter names depend on the component name, strategy, key/group names, and the merge method's parameter name.
# See the [[Configuration]] wiki page for detailed naming conventions.
custom_bounds:
  # --- Examples based on merge_method having an 'alpha' parameter ---

  # If strategy: all for 'unet'
  # "unet.input_blocks.0.0.weight_alpha": [0.1, 0.9]

  # If strategy: select for 'txt1' with key "transformer.text_model.encoder.layers.10.mlp.fc1.weight"
  # "transformer.text_model.encoder.layers.10.mlp.fc1.weight_alpha": [0.2, 0.8]

  # If strategy: group for 'txt2' with group name 'text_encoder_early_layers'
  # text_encoder_early_layers_alpha: [0.3, 0.7]

  # If strategy: single for 'vae'
  # vae_single_param_alpha: [0.4, 0.6]

  # --- General Examples ---
  # Override bounds for *all* parameters named 'constraint' (if generated by the strategies)
  constraint: [0.01, 0.2]

  # Override bounds for *all* parameters named 'k'
  # k: [0.1, 0.5]

  # Set a fixed value for a parameter (it won't be optimized)
  # some_parameter_name: 0.75

  # Define categorical options
  # some_categorical_parameter: [128, 256, 512]

  # Define binary options
  # some_binary_parameter: [0, 1]


# --- Deprecated/Obsolete Sections ---
# custom_ranges: # Removed - Use custom_bounds with specific key names instead
# merge_keys: # Removed - sd-mecha might handle key filtering differently if needed
#   enabled: False
